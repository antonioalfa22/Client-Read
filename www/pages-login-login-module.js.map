{"version":3,"sources":["webpack:///./node_modules/jwt-decode/lib/atob.js","webpack:///./node_modules/jwt-decode/lib/base64_url_decode.js","webpack:///./node_modules/jwt-decode/lib/index.js","webpack:///./src/app/pages/login/login.module.ts","webpack:///./src/app/pages/login/login.page.html","webpack:///./src/app/pages/login/login.page.scss","webpack:///./src/app/pages/login/login.page.ts"],"names":[],"mappings":"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","file":"pages-login-login-module.js","sourcesContent":["/**\n * The code was extracted from:\n * https://github.com/davidchambers/Base64.js\n */\n\nvar chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=';\n\nfunction InvalidCharacterError(message) {\n  this.message = message;\n}\n\nInvalidCharacterError.prototype = new Error();\nInvalidCharacterError.prototype.name = 'InvalidCharacterError';\n\nfunction polyfill (input) {\n  var str = String(input).replace(/=+$/, '');\n  if (str.length % 4 == 1) {\n    throw new InvalidCharacterError(\"'atob' failed: The string to be decoded is not correctly encoded.\");\n  }\n  for (\n    // initialize result and counters\n    var bc = 0, bs, buffer, idx = 0, output = '';\n    // get next character\n    buffer = str.charAt(idx++);\n    // character found in table? initialize bit storage and add its ascii value;\n    ~buffer && (bs = bc % 4 ? bs * 64 + buffer : buffer,\n      // and if not first of each 4 characters,\n      // convert the first 8 bits to one ascii character\n      bc++ % 4) ? output += String.fromCharCode(255 & bs >> (-2 * bc & 6)) : 0\n  ) {\n    // try to find character in table (0-63, not found => -1)\n    buffer = chars.indexOf(buffer);\n  }\n  return output;\n}\n\n\nmodule.exports = typeof window !== 'undefined' && window.atob && window.atob.bind(window) || polyfill;\n","var atob = require('./atob');\n\nfunction b64DecodeUnicode(str) {\n  return decodeURIComponent(atob(str).replace(/(.)/g, function (m, p) {\n    var code = p.charCodeAt(0).toString(16).toUpperCase();\n    if (code.length < 2) {\n      code = '0' + code;\n    }\n    return '%' + code;\n  }));\n}\n\nmodule.exports = function(str) {\n  var output = str.replace(/-/g, \"+\").replace(/_/g, \"/\");\n  switch (output.length % 4) {\n    case 0:\n      break;\n    case 2:\n      output += \"==\";\n      break;\n    case 3:\n      output += \"=\";\n      break;\n    default:\n      throw \"Illegal base64url string!\";\n  }\n\n  try{\n    return b64DecodeUnicode(output);\n  } catch (err) {\n    return atob(output);\n  }\n};\n","'use strict';\n\nvar base64_url_decode = require('./base64_url_decode');\n\nfunction InvalidTokenError(message) {\n  this.message = message;\n}\n\nInvalidTokenError.prototype = new Error();\nInvalidTokenError.prototype.name = 'InvalidTokenError';\n\nmodule.exports = function (token,options) {\n  if (typeof token !== 'string') {\n    throw new InvalidTokenError('Invalid token specified');\n  }\n\n  options = options || {};\n  var pos = options.header === true ? 0 : 1;\n  try {\n    return JSON.parse(base64_url_decode(token.split('.')[pos]));\n  } catch (e) {\n    throw new InvalidTokenError('Invalid token specified: ' + e.message);\n  }\n};\n\nmodule.exports.InvalidTokenError = InvalidTokenError;\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { Routes, RouterModule } from '@angular/router';\r\nimport { FormsModule, ReactiveFormsModule } from '@angular/forms';\r\nimport { IonicModule } from '@ionic/angular';\r\nimport { LoginPage } from './login.page';\r\n\r\nconst routes: Routes = [\r\n  {\r\n    path: '',\r\n    component: LoginPage\r\n  }\r\n];\r\n\r\n@NgModule({\r\n  imports: [\r\n    CommonModule,\r\n    FormsModule,\r\n    ReactiveFormsModule,\r\n    IonicModule,\r\n    RouterModule.forChild(routes)\r\n  ],\r\n  declarations: [LoginPage],\r\n  exports: [\r\n    ReactiveFormsModule,\r\n    FormsModule,\r\n    CommonModule\r\n  ]\r\n})\r\nexport class LoginPageModule {}\r\n","module.exports = \"<ion-header>\\r\\n  <ion-toolbar>\\r\\n    <ion-buttons slot=\\\"start\\\">\\r\\n      <ion-menu-button></ion-menu-button>\\r\\n    </ion-buttons>\\r\\n    <ion-title>\\r\\n      Client-Auditory\\r\\n    </ion-title>\\r\\n  </ion-toolbar>\\r\\n</ion-header>\\r\\n<ion-content padding>\\r\\n\\r\\n<ion-grid>\\r\\n  <ion-row class=\\\"ion-justify-content-center\\\">\\r\\n    <ion-col class=\\\"ion-align-items-center\\\" sizeMd=\\\"6\\\" sizeXs=\\\"12\\\" sizeLg=\\\"6\\\">\\r\\n      <ion-img src=\\\"../assets/img/logo2.png\\\" class=\\\"imgLogin\\\"></ion-img>\\r\\n    </ion-col>\\r\\n  </ion-row>\\r\\n  <ion-row class=\\\"ion-justify-content-center\\\">\\r\\n    <ion-col class=\\\"ion-align-items-center\\\" sizeMd=\\\"6\\\" sizeXs=\\\"12\\\" sizeLg=\\\"6\\\">\\r\\n      <form [formGroup]=\\\"loginform\\\" (ngSubmit)=\\\"login()\\\" autocomplete=\\\"off\\\">\\r\\n        <ion-item>\\r\\n          <ion-label  position=\\\"stacked\\\" color=\\\"orange\\\" stacked>Usuario</ion-label>\\r\\n          <input type=\\\"text\\\"  formControlName=\\\"user\\\" class=\\\"form-control\\\" [class.is-invalid]=\\\"error_inicio == true\\\" placeholder=\\\"username\\\" [(ngModel)]=\\\"userValue\\\">\\r\\n        </ion-item>\\r\\n        <ion-item lines=\\\"none\\\" *ngIf=\\\"error_inicio == true\\\">\\r\\n          <p>Seleccione un usuario existente y con privilegios de auditor</p>\\r\\n        </ion-item>\\r\\n        <ion-item>\\r\\n          <ion-label position=\\\"stacked\\\" color=\\\"orange\\\" stacked>Contraseña</ion-label>\\r\\n          <input type=\\\"password\\\"  formControlName=\\\"password\\\" class=\\\"form-control\\\" [class.is-invalid]=\\\"error_inicio == true\\\" placeholder=\\\"password\\\" [(ngModel)]=\\\"passValue\\\">\\r\\n        </ion-item>\\r\\n        <ion-item lines=\\\"none\\\" *ngIf=\\\"error_inicio == true\\\">\\r\\n          <p>Contraseña o usuario incorrectos</p>\\r\\n        </ion-item>\\r\\n        <button class=\\\"btn btn-orange btn-round btn-block\\\" expand=\\\"full\\\" type=\\\"submit\\\">login</button>\\r\\n\\r\\n      </form>\\r\\n\\r\\n    </ion-col>\\r\\n  </ion-row>\\r\\n</ion-grid>\\r\\n<ion-footer>\\r\\n  <ion-toolbar>\\r\\n    © Copyright Antonio Payá González 2019\\r\\n  </ion-toolbar>\\r\\n</ion-footer>\\r\\n</ion-content>\"","module.exports = \"p {\\n  font-size: 0.8em;\\n  color: red; }\\n\\n.invalid {\\n  border: 1px solid #ea6153; }\\n\\n.imgLogin {\\n  height: 200px; }\\n\\nion-content {\\n  --background:rgb(255, 255, 255); }\\n\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9hcHAvcGFnZXMvbG9naW4vQzpcXFVzZXJzXFxhbnRvblxcRGVza3RvcFxcVEZHXFxQbGFudGlsbGFzXFxDbGllbnQtQXVkaXRvcnkvc3JjXFxhcHBcXHBhZ2VzXFxsb2dpblxcbG9naW4ucGFnZS5zY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0VBQ0ksZ0JBQWdCO0VBQ2hCLFVBQVUsRUFBQTs7QUFHZDtFQUNJLHlCQUF5QixFQUFBOztBQUc3QjtFQUNJLGFBQWEsRUFBQTs7QUFHakI7RUFDSSwrQkFBYSxFQUFBIiwiZmlsZSI6InNyYy9hcHAvcGFnZXMvbG9naW4vbG9naW4ucGFnZS5zY3NzIiwic291cmNlc0NvbnRlbnQiOlsicCB7XHJcbiAgICBmb250LXNpemU6IDAuOGVtO1xyXG4gICAgY29sb3I6IHJlZDtcclxufVxyXG5cclxuLmludmFsaWQge1xyXG4gICAgYm9yZGVyOiAxcHggc29saWQgI2VhNjE1MztcclxufVxyXG5cclxuLmltZ0xvZ2luIHtcclxuICAgIGhlaWdodDogMjAwcHg7XHJcbn1cclxuXHJcbmlvbi1jb250ZW50e1xyXG4gICAgLS1iYWNrZ3JvdW5kOnJnYigyNTUsIDI1NSwgMjU1KTtcclxuICB9Il19 */\"","import { UserService } from './../../services/user/user.service';\r\nimport { Component, OnInit } from '@angular/core';\r\nimport { FormGroup, FormBuilder, Validators } from '@angular/forms';\r\nimport { Router } from '@angular/router';\r\nimport { Platform, MenuController } from '@ionic/angular';\r\nimport * as jwt_decode from \"jwt-decode\";\r\n\r\n@Component({\r\n    selector: 'app-login',\r\n    templateUrl: './login.page.html',\r\n    styleUrls: ['./login.page.scss'],\r\n})\r\nexport class LoginPage implements OnInit {\r\n\r\n    private loginform: FormGroup;\r\n    public error_inicio: boolean;\r\n    public userValue: String;\r\n    public passValue: String;\r\n\r\n\r\n    constructor(\r\n        public menuCtrl: MenuController,\r\n        private formBuilder: FormBuilder,\r\n        private userApi: UserService,\r\n        private router: Router,\r\n        private platform: Platform\r\n    ) {\r\n        this.userValue = '';\r\n        this.passValue = '';\r\n    }\r\n\r\n    ionViewWillEnter() {\r\n        this.menuCtrl.enable(false);\r\n    }\r\n\r\n    ngOnInit() {\r\n        this.loginform = this.formBuilder.group({\r\n            user: ['', Validators.required],\r\n            password: ['', Validators.required]\r\n        }\r\n        );\r\n    }\r\n\r\n    login() {\r\n        if (this.loginform.invalid) {\r\n            return;\r\n        }\r\n        const data = {\r\n            userName: this.loginform.value['user'],\r\n            password: this.loginform.value['password']\r\n        };\r\n\r\n        this.userApi.login(data).subscribe(res => {\r\n            let rol = jwt_decode(res).rol;\r\n            if (rol === \"auditor\") {\r\n                this.userApi.setToken(res);\r\n                this.menuCtrl.enable(true);\r\n                this.router.navigate(['/home'], { replaceUrl: true });\r\n            } else {\r\n                this.error_inicio = true;\r\n                this.userValue = '';\r\n                this.passValue = '';\r\n            }\r\n        },\r\n            err => {\r\n                this.error_inicio = true;\r\n                this.userValue = '';\r\n                this.passValue = '';\r\n\r\n            });\r\n    }\r\n\r\n    esMovil() {\r\n        if (this.platform.is('mobileweb') || this.platform.is('mobile')) {\r\n            return true;\r\n        } else {\r\n            return false;\r\n        }\r\n    }\r\n\r\n}"],"sourceRoot":""}